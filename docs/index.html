<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flipkart Casino Slot â€“ Spin & Win</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: radial-gradient(circle at top, #1a237e, #000);
    color: #fff;
    text-align: center;
    margin: 0;
    padding: 0;
  }

  header {
    padding: 16px;
    background: #2874f0;
    font-weight: bold;
    letter-spacing: 1px;
  }

  .machine {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 40px;
    perspective: 1000px;
  }

  .reel {
    width: 100px;
    height: 120px;
    border: 4px solid #ffeb3b;
    border-radius: 12px;
    overflow: hidden;
    background: #111;
    box-shadow: inset 0 0 10px #000, 0 0 20px #ffeb3b;
  }

  .icons {
    position: relative;
    top: 0;
    transition: top 1s ease-out;
  }

  .icons img {
    display: block;
    width: 100%;
    height: 120px;
    object-fit: contain;
    background: #000;
  }

  #spinBtn {
    margin-top: 24px;
    padding: 14px 30px;
    font-size: 1.2rem;
    font-weight: bold;
    color: #222;
    background: #ffeb3b;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(255,255,255,0.3);
  }

  #result {
    margin-top: 20px;
    font-size: 1.3rem;
    font-weight: bold;
  }

  canvas#confetti-canvas {
    position: fixed;
    top:0;left:0;
    width:100%;height:100%;
    pointer-events:none;
    z-index:999;
  }
</style>
</head>
<body>

<header>ðŸŽ° Flipkart Slot Machine â€“ Spin & Win</header>

<div class="machine">
  <div class="reel" id="reel1">
    <div class="icons">
      <img src="nothing.png" alt="">
      <img src="ipad.png" alt="">
      <img src="ps5.png" alt="">
      <img src="watch.png" alt="">
      <img src="iphone.png" alt="">
    </div>
  </div>

  <div class="reel" id="reel2">
    <div class="icons">
      <img src="nothing.png" alt="">
      <img src="ipad.png" alt="">
      <img src="ps5.png" alt="">
      <img src="watch.png" alt="">
      <img src="iphone.png" alt="">
    </div>
  </div>

  <div class="reel" id="reel3">
    <div class="icons">
      <img src="nothing.png" alt="">
      <img src="ipad.png" alt="">
      <img src="ps5.png" alt="">
      <img src="watch.png" alt="">
      <img src="iphone.png" alt="">
    </div>
  </div>
</div>

<button id="spinBtn">SPIN</button>
<div id="result"></div>

<canvas id="confetti-canvas"></canvas>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const reels = document.querySelectorAll('.icons');
const spinBtn = document.getElementById('spinBtn');
const result = document.getElementById('result');
let spins = 0;

function spinReel(reel, stopIndex, delay) {
  return new Promise(resolve => {
    let totalItems = reel.children.length;
    let itemHeight = 120;
    let rounds = 4; // how many times it scrolls through
    let distance = (rounds * totalItems + stopIndex) * itemHeight;
    reel.style.transition = 'none';
    reel.style.top = '0px';
    void reel.offsetWidth; // force reflow
    reel.style.transition = `top 1s ease-out ${delay}s`;
    reel.style.top = `-${distance}px`;
    setTimeout(resolve, (1 + delay) * 1000);
  });
}

function fireConfetti() {
  const duration = 3 * 1000;
  const end = Date.now() + duration;
  (function frame() {
    confetti({ particleCount: 6, spread: 70, origin: { y: 0.6 } });
    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}

spinBtn.addEventListener('click', async () => {
  spins++;
  spinBtn.disabled = true;
  result.textContent = '';

  // stopIndex corresponds to order in the list (0=nothing, 4=iphone)
  let stopIndex = 0; // blank by default
  if (spins === 3) stopIndex = 4; // iphone

  // spin all three wheels
  await Promise.all([
    spinReel(reels[0], stopIndex, 0),
    spinReel(reels[1], stopIndex, 0.2),
    spinReel(reels[2], stopIndex, 0.4)
  ]);

  if (spins < 3) {
    result.textContent = "âŒ No luck, try again!";
  } else {
    result.textContent = "ðŸŽ‰ JACKPOT! You won iPhones!";
    fireConfetti();
  }

  spinBtn.disabled = false;
});
</script>
</body>
</html>
